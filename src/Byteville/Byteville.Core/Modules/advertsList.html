<template>
    <require from="./Helpers/date-format"></require>
    <require from="./Helpers/currency-format"></require>
    <require from="./Helpers/date-from-now"></require>
    <require from="./Controls/districts-filter"></require>
    <require from="./Controls/timespan-filter"></require>
    <div class="trends">
        <h2>Trendy</h2>
        <ul repeat.for="trend of trends">
            <li class="bv-trend" click.delegate="setInput(trend.key)"><b>${trend.key}</b> (${trend.docCount})</li>
        </ul>
    </div>
    <div class="bv-menu-options">
        <div class="bv-search">
            <input autofocus type="text" placeholder="Czego szukasz ?" value.bind="params.q & throttle:500" />
        </div>
        <div class="btn-group">
            <districts-filter selected-district.bind="params.district" change.delegate="filterChanged()"></districts-filter>
            <timespan-filter selected-span.bind="params.timespan" change.delegate="filterChanged()"></timespan-filter>
        </div>       
    </div>
    <div class="container">
        <div repeat.for="advert of adverts">
            <div class="search-result">
                <h3 class="ad-title">${advert.title}</h3>
                <div class="ad-middle-container">
                    <div class="ad-price">
                        ${advert.totalPrice | currencyFormat} zl / ${advert.area} m2 (${advert.pricePerMeter | currencyFormat} zl za m2)
                    </div>
                    <div class="ad-date">
                        <div>${advert.creationDate | dateFormat}</div>
                        <div>${advert.creationDate | dateFromNow}</div>
                    </div>
                </div>
                <div class="ad-geo">
                    <span class="ad-district">${advert.district}</span>,
                    <span class="ad-street"><a href="/#streets/${advert.street}">${advert.street}</a></span>
                </div>
            </div>
        </div>
    </div>
</template>

